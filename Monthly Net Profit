-- Query: Monthly Financial Overview
-- Description: Calculates total revenue, total expenses, and net profit per month
-- Performed by: Sevarakhon 
-- Date: 2025-07-02

SELECT
    r.date AS Month,
    SUM(r.amount) AS Total_revenue,
    (
        SELECT SUM(e.amount)
        FROM expenses e
        WHERE strftime('%Y-%m', e.date) = strftime('%Y-%m', r.date)
    ) AS Total_expenses,
    SUM(r.amount) -
    (
        SELECT SUM(e.amount)
        FROM expenses e
        WHERE strftime('%Y-%m', e.date) = strftime('%Y-%m', r.date)
    ) AS Profit
FROM revenues r
GROUP BY strftime('%Y-%m', r.date)
ORDER BY r.date;
